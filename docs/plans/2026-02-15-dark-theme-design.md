# AICowork æš—è‰²ä¸»é¢˜è®¾è®¡æ–¹æ¡ˆ

> æ—¥æœŸï¼š2026-02-15
> çŠ¶æ€ï¼šå¾…å®ç°

## 1. å†³ç­–æ‘˜è¦

| å†³ç­–é¡¹ | é€‰æ‹© | è¯´æ˜ |
|--------|------|------|
| ç”¨æˆ·æ§åˆ¶æ–¹å¼ | ä¸‰é€‰ä¸€ï¼ˆç³»ç»Ÿ / æš—è‰² / äº®è‰²ï¼‰ | è®¾ç½®é¡µæ‰‹åŠ¨é€‰æ‹©ï¼Œé»˜è®¤è·Ÿéšç³»ç»Ÿ |
| CSS å˜é‡ç­–ç•¥ | åŸºäºç°æœ‰ `index.css` æ‰©å±• | ä¸è¿ç§»åˆ° shadcn ä½“ç³»ï¼Œç»„ä»¶é›¶æ”¹åŠ¨ |
| CSS åˆ‡æ¢æœºåˆ¶ | `prefers-color-scheme` åª’ä½“æŸ¥è¯¢ | ç”± Electron `nativeTheme.themeSource` é©±åŠ¨ |
| é…è‰²é£æ ¼ | Claude å®˜æ–¹æš–ç°é£æ ¼ | ä¸ç”¨çº¯é»‘ï¼Œæš–ç°è‰²è°ƒæ­é…æ©™è‰² accent |

## 2. æ¶æ„

### æ•°æ®æµ

```
ç”¨æˆ·é€‰æ‹© (DisplaySection UI)
  â†’ IPC invoke: set-theme("dark")
  â†’ ä¸»è¿›ç¨‹: nativeTheme.themeSource = "dark"
  â†’ Chromium è‡ªåŠ¨æ›´æ–° prefers-color-scheme
  â†’ CSS @media (prefers-color-scheme: dark) ç”Ÿæ•ˆ
  â†’ æ‰€æœ‰ CSS å˜é‡åˆ‡æ¢ä¸ºæš—è‰²å€¼
  â†’ åŒæ—¶æŒä¹…åŒ–åˆ° theme-preference.json
```

### å¯åŠ¨æµç¨‹

```
app.ready
  â†’ loadThemePreference()  // è¯»å– theme-preference.json
  â†’ nativeTheme.themeSource = savedValue  // åœ¨åˆ›å»ºçª—å£å‰è®¾ç½®
  â†’ createMainWindow()  // çª—å£åˆ›å»ºæ—¶å·²ç»æ˜¯æ­£ç¡®çš„ä¸»é¢˜
```

## 3. æ–‡ä»¶æ”¹åŠ¨æ¸…å•

### æ–°å¢æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `src/electron/storage/theme-store.ts` | ä¸»é¢˜åå¥½æŒä¹…åŒ–ï¼ˆ~30 è¡Œï¼‰ |

### ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|
| `src/ui/index.css` | æ–°å¢ `@media (prefers-color-scheme: dark)` æš—è‰²å˜é‡å—ï¼›åˆ‡æ¢ highlight.js ä¸»é¢˜ï¼›æš—è‰²æ»šåŠ¨æ¡ |
| `src/ui/pages/SettingsPage/sections/DisplaySection.tsx` | æ–°å¢ä¸»é¢˜ä¸‰é€‰ä¸€å¡ç‰‡ UI |
| `src/electron/main.ts` | `app.ready` ä¸­è¯»å–å¹¶åº”ç”¨ä¸»é¢˜åå¥½ |
| `src/electron/preload.cts` | æ–°å¢ `get-theme` / `set-theme` IPC é€šé“ |
| `src/electron/main/ipc-registry.ts` | æ³¨å†Œä¸»é¢˜ç›¸å…³ IPC handler |

### æ— éœ€ä¿®æ”¹

æ‰€æœ‰ç»„ä»¶æ–‡ä»¶ã€‚ç»„ä»¶å·²ä½¿ç”¨ `bg-surface`ã€`text-ink-900` ç­‰è¯­ä¹‰åŒ– Tailwind ç±»åï¼ŒCSS å˜é‡åˆ‡æ¢åè‡ªåŠ¨ç”Ÿæ•ˆã€‚

## 4. æš—è‰²é…è‰²è¡¨

åŸºäº Claude å®˜æ–¹æš–ç°é£æ ¼ï¼Œå¯¹ç°æœ‰ `index.css` ä¸­æ¯ä¸ªå˜é‡å®šä¹‰æš—è‰²å€¼ï¼š

### Surface é¢œè‰²

| å˜é‡ | äº®è‰²å€¼ | æš—è‰²å€¼ | è¯´æ˜ |
|------|--------|--------|------|
| `--color-surface` | `#FFFFFF` | `#1A1915` | ä¸»èƒŒæ™¯ - æ·±æš–ç° |
| `--color-surface-secondary` | `#F5F4F1` | `#242320` | æ¬¡çº§é¢æ¿ |
| `--color-surface-tertiary` | `#EFEEE9` | `#2D2C28` | å¡ç‰‡/hover |
| `--color-surface-cream` | `#FAF9F6` | `#1F1E1A` | å¥¶æ²¹è‰² â†’ æ·±æš–ç° |

### Ink é¢œè‰²ï¼ˆæ–‡å­—ï¼‰

| å˜é‡ | äº®è‰²å€¼ | æš—è‰²å€¼ | è¯´æ˜ |
|------|--------|--------|------|
| `--color-ink-900` | `#1A1915` | `#F5F4F1` | ä¸»æ–‡å­— - è¿‘ç™½ |
| `--color-ink-800` | `#2D2D2A` | `#E5E4DF` | æ¬¡çº§æ–‡å­— |
| `--color-ink-700` | `#4A4A45` | `#B8B7B2` | ä¸‰çº§æ–‡å­— |
| `--color-ink-600` | `#666661` | `#8A8985` | è¾…åŠ©æ–‡å­— |
| `--color-ink-500` | `#7A7A75` | `#6E6D69` | å¼±åŒ–æ–‡å­— |
| `--color-ink-400` | `#9B9B96` | `#555450` | æœ€å¼±æ–‡å­— |

### Muted é¢œè‰²

| å˜é‡ | äº®è‰²å€¼ | æš—è‰²å€¼ |
|------|--------|--------|
| `--color-muted` | `#6B6B66` | `#8A8985` |
| `--color-muted-light` | `#9B9B96` | `#6E6D69` |

### Accent é¢œè‰²ï¼ˆClaude æ©™ï¼‰

| å˜é‡ | äº®è‰²å€¼ | æš—è‰²å€¼ | è¯´æ˜ |
|------|--------|--------|------|
| `--color-accent` | `#D97757` | `#E08A6D` | ç¨å¾®æäº®å¢å¼ºå¯è§åº¦ |
| `--color-accent-hover` | `#CC785C` | `#D9977E` | hover æ€ |
| `--color-accent-light` | `#F5D0C5` | `#3D2A22` | æµ…æ©™ â†’ æ·±æ©™èƒŒæ™¯ |
| `--color-accent-subtle` | `#FDF4F1` | `#2A1F1A` | ææµ… â†’ ææ·±æ©™èƒŒæ™¯ |

### Status é¢œè‰²

| å˜é‡ | äº®è‰²å€¼ | æš—è‰²å€¼ |
|------|--------|--------|
| `--color-error` | `#DC2626` | `#F87171` |
| `--color-error-light` | `#FEE2E2` | `#3B1515` |
| `--color-success` | `#16A34A` | `#4ADE80` |
| `--color-success-light` | `#DCFCE7` | `#0D2818` |
| `--color-info` | `#2563EB` | `#60A5FA` |
| `--color-info-light` | `#DBEAFE` | `#1A2744` |

### Background é¢œè‰²

| å˜é‡ | äº®è‰²å€¼ | æš—è‰²å€¼ | è¯´æ˜ |
|------|--------|--------|------|
| `--color-bg-000` | `#FFFFFF` | `#131210` | æœ€æ·±åº•å±‚ |
| `--color-bg-100` | `#FAF9F6` | `#1A1915` | ä¸»èƒŒæ™¯ |
| `--color-bg-200` | `#F5F4F1` | `#242320` | é¢æ¿ |
| `--color-bg-300` | `#EFEEE9` | `#2D2C28` | å¡ç‰‡ |
| `--color-bg-400` | `#E5E4DF` | `#373630` | è¾¹æ¡†/åˆ†éš”çº¿ |

### Shadow

| å˜é‡ | äº®è‰²å€¼ | æš—è‰²å€¼ |
|------|--------|--------|
| `--shadow-soft` | `0 1px 2px rgba(0,0,0,0.05)` | `0 1px 2px rgba(0,0,0,0.2)` |
| `--shadow-card` | `0 4px 16px rgba(0,0,0,0.08)` | `0 4px 16px rgba(0,0,0,0.3)` |
| `--shadow-elevated` | `0 8px 32px rgba(0,0,0,0.12)` | `0 8px 32px rgba(0,0,0,0.4)` |

## 5. è®¾ç½® UI

åœ¨ `DisplaySection` ç°æœ‰å¼€å…³ä¸Šæ–¹æ–°å¢ä¸»é¢˜é€‰æ‹©å™¨ï¼Œä¸‰ä¸ªæ¨ªæ’å¡ç‰‡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â˜€ï¸          â”‚  â”‚   ğŸŒ™          â”‚  â”‚   ğŸ’»          â”‚
â”‚   äº®è‰²        â”‚  â”‚   æš—è‰²        â”‚  â”‚   è·Ÿéšç³»ç»Ÿ     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ äº®è‰²é¢„è§ˆ â”‚  â”‚  â”‚ æš—è‰²é¢„è§ˆ â”‚  â”‚  â”‚ åŠäº®åŠæš—  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- é€‰ä¸­çŠ¶æ€ï¼š`accent` è‰² 2px è¾¹æ¡† + æµ…æ©™èƒŒæ™¯
- æœªé€‰ä¸­ï¼šæ™®é€š `border-ink-900/10` è¾¹æ¡†
- é»˜è®¤å€¼ï¼š`system`
- é¢„è§ˆè‰²å—ç”¨çº¯ CSS div è¡¨ç¤ºï¼ˆsurface è‰²èƒŒæ™¯ + ink è‰²æ–‡å­—æ¡ï¼‰

## 6. ä»£ç é«˜äº®

åŒæ—¶å¼•å…¥äº®è‰²å’Œæš—è‰² highlight.js ä¸»é¢˜ï¼Œé€šè¿‡ CSS import åª’ä½“æŸ¥è¯¢è‡ªåŠ¨åˆ‡æ¢ï¼š

```css
@import "highlight.js/styles/github.css" (prefers-color-scheme: light);
@import "highlight.js/styles/github-dark.css" (prefers-color-scheme: dark);
```

## 7. æ»šåŠ¨æ¡

```css
@media (prefers-color-scheme: dark) {
  ::-webkit-scrollbar-thumb { background: #4A4A45; }
  ::-webkit-scrollbar-thumb:hover { background: #6E6D69; }
}
```

## 8. IPC åè®®

### `get-theme`

- æ–¹å‘ï¼šrenderer â†’ main
- å‚æ•°ï¼šæ— 
- è¿”å›ï¼š`"system" | "dark" | "light"`

### `set-theme`

- æ–¹å‘ï¼šrenderer â†’ main
- å‚æ•°ï¼š`theme: "system" | "dark" | "light"`
- è¡Œä¸ºï¼šä¿å­˜åå¥½åˆ°æ–‡ä»¶ + è®¾ç½® `nativeTheme.themeSource` + å³æ—¶ç”Ÿæ•ˆ
- è¿”å›ï¼š`void`

## 9. æŒä¹…åŒ–

æ–‡ä»¶ï¼š`{userData}/theme-preference.json`

```json
{
  "theme": "system"
}
```

å¤ç”¨ç°æœ‰ `config-store.ts` çš„æ–‡ä»¶å­˜å–æ¨¡å¼ï¼ˆ`app.getPath("userData")`ï¼‰ã€‚

## 10. å®ç°é¡ºåº

1. `theme-store.ts` â€” æŒä¹…åŒ–å±‚
2. `main.ts` + IPC â€” ä¸»è¿›ç¨‹é›†æˆ
3. `index.css` â€” æš—è‰²å˜é‡ + é«˜äº® + æ»šåŠ¨æ¡
4. `DisplaySection.tsx` â€” è®¾ç½® UI
5. ç«¯åˆ°ç«¯æµ‹è¯•éªŒè¯
